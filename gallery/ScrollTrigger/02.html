<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/02.css">
    <link rel="stylesheet" href="css/font.css">
    <link rel="stylesheet" href="css/swiper-bundle.min.css">

    <script src="js/swiper-bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.1/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.1/ScrollTrigger.min.js"></script>
</head>
<body>
    <div class="wrap">
        <section class="visual">
            <div class="inner">
                <div class="textBox">
                    <span class="title">Shooting</span>
                    <span class="subTitle">Ci interessa raccontare storie con parole e immagini che estrapoliamo dall'universo simbolico di ogni brand.</span>
                    <span class="text">La definizione di ogni progetto passa sempre per un'indagine, ovvero una stimolante fusione tra analisi e creatività per valorizzare al massimo il potenziale del prodotto, al di là della funzionalità e dell'usabilità. Attingiamo a piene mani agli aspetti visuali/culturali che qualificano il cliente e catalizziamo nell’idea progettuale più discorsi narrativi possibili, rispettando l'anima del brand.</span>
                </div>
                <div class="aniBox">
                    <img src="img/ex_2/img_0.png" alt="">
                    <div class="textBox">
                        <span>SCROLL FOR <br> THE ARCHIVES</span>
                    </div>
                </div>
            </div>
        </section>
        <section class="project">
            <ul class="nav">
                <li><a href="#scrollA">ADV CAMPAIGN</a></li>
                <li><a href="#scrollB">FASHION STORY</a></li>
                <li><a href="#scrollC">CREATIVE CONTENT</a></li>
            </ul>
            <div class="swiper mySwiper" data-color="#d14244" id="scrollA">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_1.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cromia</span>
                            <span class="text">Stories di stile</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_2.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Calliope</span>
                            <span class="text">Live the Beauty</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_3.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">keys</span>
                            <span class="text">Every day All day</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_4.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cult</span>
                            <span class="text">Crawling in the Dark</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_5.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Fru.it</span>
                            <span class="text">Beauty in Maimi</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_6.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">7AM</span>
                            <span class="text">About al Girl</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-pagination">
                </div>
            </div>
            <div class="swiper mySwiper" data-color="#f06f4f" id="scrollB">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_7.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cromia</span>
                            <span class="text">Stories di stile</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_8.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Calliope</span>
                            <span class="text">Live the Beauty</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_9.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">keys</span>
                            <span class="text">Every day All day</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_10.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cult</span>
                            <span class="text">Crawling in the Dark</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_11.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Fru.it</span>
                            <span class="text">Beauty in Maimi</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-pagination">
                </div>
            </div>
            <div class="swiper mySwiper" data-color="#3e7788" id="scrollC">
                <div class="swiper-wrapper">
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_12.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cromia</span>
                            <span class="text">Stories di stile</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_13.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Calliope</span>
                            <span class="text">Live the Beauty</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_14.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">keys</span>
                            <span class="text">Every day All day</span>
                        </div>
                    </div>
                    <div class="swiper-slide">
                        <div class="imgBox">
                            <img src="img/ex_2/img_15.jpg" alt="">
                        </div>
                        <div class="textBox">
                            <span class="title">Cult</span>
                            <span class="text">Crawling in the Dark</span>
                        </div>
                    </div>
                </div>
                <div class="swiper-pagination">
                </div>
            </div>
        </section>
    </div>
    <script>
        //01.textBox에 active클래스 붙이기
        let textBox = gsap.utils.toArray('.textBox')
        textBox.forEach((textBox, i) => {
            ScrollTrigger.create({
                trigger:textBox,
                start:'top bottom',
                toggleClass:{targets:textBox, className:'active'},
                once:true,
                /* markers:true */
            });
        }); 

        //02.swiper 호출
        var swiper = new Swiper(".mySwiper",{
            slidesPerView:4,
            spaceBetween:50,
            centeredSlides:true,
            pagination:{
                el:".swiper-pagination",
                type:"fraction",
                formatFractionCurrent: function(number) {return('0' + number).slice(-2)}, //페이지넘버에 0붙이고싶을때!(두자릿수로 할때)
                formatFractionTotal: function(number) {return('0' + number).slice(-2)} //한자리수를 원할 경우 적지않는다.
            }
        });
        //03.swiper 위치에 따른 wrap color 변경
        gsap.utils.toArray(".mySwiper").forEach(function(bg){
        var color = bg.getAttribute('data-color');

            ScrollTrigger.create({
                trigger:bg,
                start:'top center',
                end:'bottom center',
                /* markers:true, */
                scrub:true,
                onEnter:() =>gsap.to('.wrap',{//onEnter -스크롤위치가 '시작'을 지나 앞으로 이동할 때
                    backgroundColor: color,
                    duration:1
                }),
                onEnterBack: () => gsap.to('.wrap',{//onEnterBack =>스크롤의 위치가 '끝'을 지나 뒤로 이동할 때
                    backgroundColor:color,
                    duration:1
                }),
                onLeaveBack: () =>gsap.to('.wrap',{//onLeaveBack => 스크롤 위치가 시작을 지나 뒤로 이동할때
                    backgroundColor:'#d14244',
                    duration:1
                })
            });
        });

        gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);//플러그인 등록

        //04.nav 숨겼다가 project가 나오면 활성화를 위해 .project.active추가
        let pro = gsap.utils.toArray(".project");

        ScrollTrigger.create({
            trigger:pro,
            start:'top center',
            end :'bottom center',
            toggleClass:{targets:pro, className:"active"}
        });

// 05.nav네비게이션 스크롤이동과 a에 active클래스 추가
let links = gsap.utils.toArray(".nav a");
    
    links.forEach(a => {
      let href = document.querySelector(a.getAttribute("href")), // .nav a 의 href 값 곧 .mySwiper의 ID를 href 변수에 저장
          
          linkST = ScrollTrigger.create({
                trigger: href,
                start: "top 15%",
                //markers:true
          });
        
          ScrollTrigger.create({
            trigger: href,
            start: "top center",
            end: "bottom center",
            //markers:true,
            onToggle: self => self.isActive && setActive(a)      
          });
           /*
              - onToggle - 스크롤 위치가 어느 방향으로든 "시작" 또는 "종료"를 지나 이동할 때 , setActive 함수실행
              - isActive는 현재애니메이션의 활성상태를 나타내므로 return이 활성되면 true
              - setActive(a) : 요소(a)를 현재문서의 활성요소로 셋팅 
              - 화살표함수(=>)는 ES6의 함수선언문법임.
               ** 결과적으로 변수 'href'의 top과 window의 center가 만나면 윈도우 스크롤이 
                 a 링크주소로 스크롤된다.
          */
          a.addEventListener("click", e => { // .nav a 클릭했을때 위에 작성한 linkST 스크롤 트리거 실행
            e.preventDefault();
            gsap.to(window, {duration: 0.8, scrollTo: linkST.start});
          });
         //DOM(Document Object Model)객체,addEventListener(이벤트명, 실행할 함수명, 옵션)   
    });
    
    function setActive(link) { // .nav a 에 스크롤 위치에 따라 혹은 클릭 했을때 active 클래스 붙여주는 함수
      links.forEach(a => a.classList.remove("active"));
      link.classList.add("active");
    }
        

 /*        //05.nav네비게이션 스크롤이동과 a에 active클래스 추가
        let links = gsap.utils.toArray(".nav a");

        links.forEach(a => {
            let href = document.querySelector(a.getAttribute("href")),
            //.nav a의 href값 곧 .mySwiper의 ID값을 href변수에 저장

            linkST = ScrollTrigger.create({
                trigger:href,
                start:"top 15%",
                //markers:true
                });
            
            ScrollTrigger.create({
                trigger:href,
                start:"top center",
                end:"bottom center",
                markers:true,
                onToggle: self => self.isActive && setActive(a)
                });
                //onToggle :스크롤의 위치가 어느방향으로든 '시작' 또는 '종료'를 지나 이동할 때,setActive 함수 실행
                //isActive는 현재 애니메이션의 활성상태를 나타내므로, return이 활성되면 true
                //onToggle에 있는 (self) window의 객체를 나타냄
                //setActive(a)는 요소(a)를 현재문서의 활성요소로 셋팅
                // => 화살표함수로 ES6의 함수선언문법
                //**결과적으로 변수'href'의 top과 window의 center가 만나면 윈도우 스크롤이 a링크로 부드럽게 스크롤
                a.addEventListener("click", e => {
                e.preventDefault();
                gsap.to(window,{duration:0.8, scrollTo: linkST.start});
                });            
        });

        function setActive(link){ // .nav a 에 스크롤 위치에 따라 혹은 클릭 했을때 active 클래스 붙여주는 함수
                link.forEach(a => a.classList.remove("active"));
                link.classList.add("active");
            }
        //DOM(document Object Model)객체, addEventListener(이벤트명, 실행할 함수, 옵션);
 */
        
    </script>
</body>
</html>